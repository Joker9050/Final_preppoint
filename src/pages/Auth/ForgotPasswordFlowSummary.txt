Forgot Password Flow Summary for PrepPoint Application

1. Overview:
The Forgot Password feature allows users to reset their password securely through a three-step process involving OTP (One-Time Password) verification.

2. Frontend Flow (ForgotPassword.jsx):
- Step 1: Request OTP
  - User enters their registered email.
  - The frontend sends a POST request to /request-otp.php with the email.
  - On success, a message is shown that OTP is sent, and the UI advances to OTP input.
  - On failure, an error message is displayed.

- Step 2: Verify OTP
  - User enters the 6-digit OTP received via email.
  - The frontend sends a POST request to /verify-otp.php with email and OTP.
  - On success, a message is shown to set a new password, and the UI advances to password reset.
  - On failure, an error message is displayed.

- Step 3: Reset Password
  - User enters new password and confirms it.
  - Frontend validates that passwords match and meet length requirements.
  - Sends a POST request to /reset-password.php with email, new_password, and confirm_password.
  - On success, a success message is shown and user is redirected to login after 3 seconds.
  - On failure, an error message is displayed.

3. Backend API Endpoints:

- request-otp.php:
  - Receives email in JSON POST.
  - Checks if user exists.
  - Generates a 6-digit OTP valid for 10 minutes.
  - Stores OTP in password_resets table.
  - Sends OTP via HTML email to user.
  - Returns success response regardless of user existence to prevent email enumeration.

- verify-otp.php:
  - Receives email and OTP in JSON POST.
  - Checks for a valid, unexpired, unused OTP in password_resets table.
  - Returns success if OTP is valid.
  - Returns error if OTP is invalid or expired.

- reset-password.php:
  - Receives email, new_password, and confirm_password in JSON POST.
  - Validates passwords match and meet length requirements.
  - Checks for a valid, unexpired, unused OTP.
  - Checks if user exists.
  - Updates user's password in the database.
  - Marks OTP as used.
  - Returns success or error messages accordingly.

4. Error and Success Handling:
- Frontend displays appropriate success and error messages for each step.
- Backend returns JSON responses with success status and messages.
- Backend prevents email enumeration by always returning success on OTP request.
- OTPs expire after 10 minutes and can only be used once.
- Password reset requires OTP verification.

5. Potential Improvement:
- The reset-password.php script appears to miss hashing the new password before storing it in the database. This should be addressed to ensure password security.

6. Summary:
This flow provides a secure and user-friendly way for users to reset their passwords using OTP verification, with clear UI feedback and backend validation.

Prepared by BLACKBOXAI
